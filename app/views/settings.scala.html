@()

@main("Site Settings", "Settings") {
    <p>Change site-level settings.</p>
    <form>
        <div class="form-group">
            <label for="universityName" class="col-sm-2 col-form-label">University Name</label>
            <div class="col-sm-2">
                <input type="text" class="form-control" id="universityName" value="@Application.Settings.getUniversityName">
            </div>
        </div>
        <div class="form-group">
            <label for="centerName" class="col-sm-2 col-form-label">Center Name</label>
            <div class="col-sm-2">
            <input type="text" class="form-control" id="centerName" value="@Application.Settings.getCenterName">
            </div>
        </div>
        <div class="form-group">
            <label for="primaryColor" class="col-sm-2 col-form-label">Primary Color</label>
            <div id="primaryColorPicker" class="input-group colorpicker-component col-sm-2">
                <input id="primaryColor" type="text" value="@Application.Settings.getPrimaryColor" class="form-control" />
                <span class="input-group-addon"><i></i></span>
            </div>
        </div>
        <div class="form-group">
            <label for="secondaryColor" class="col-sm-2 col-form-label">Secondary Color</label>
            <div id="secondaryColorPicker" class="input-group colorpicker-component col-sm-2">
                <input id="secondaryColor" type="text" value="@Application.Settings.getSecondaryColor" class="form-control" />
                <span class="input-group-addon"><i></i></span>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-2">
                @helper.CSRF.formField
                <button type="submit" onclick="updateSettings()" class="btn btn-primary">Update Site Settings</button>
            </div>
        </div>
    </form>

    <script type="text/javascript">
         $(function() {
                $('#primaryColorPicker').colorpicker();
                $('#secondaryColorPicker').colorpicker();
         });
        function updateSettings(){
            var settings = {
                universityName: $('#universityName').val(),
                centerName: $('#centerName').val(),
                primaryColor: $("#primaryColorPicker").colorpicker('getValue',$("#primaryColor").val()),
                secondaryColor: $('#secondaryColorPicker').colorpicker('getValue',$('#secondaryColor').val())
            };
            var csrfToken = $('input[name="csrfToken"]').attr('value');
            $.ajaxSetup({
                beforeSend: function (xhr) {
                    xhr.setRequestHeader('Csrf-Token', csrfToken);
                }
            });
            $.ajax({
                url: '/updateSettings',
                type: 'POST',
                data: JSON.stringify(settings),
                contentType: 'application/json',
                success: function() {
                    createAlert('info', 'Settings Updated!');
                    },
                error: function () {
                    createAlert('warning', 'Settings not updated!');
                }
            });
        }
    </script>
}

